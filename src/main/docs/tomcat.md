
---

# Инструкция: Установка и настройка Apache Tomcat 10.1.x

**Важно:** Мы используем версию **10.1.x**, так как она поддерживает спецификацию **Jakarta EE 10**. Версии Tomcat 9 и ниже (Java EE 8) используют пакеты `javax.*`, а не `jakarta.*`, и наш код на них работать не будет.

---

## Шаг 1: Скачивание сервера (для всех ОС)

1. Перейдите на официальный сайт: [tomcat.apache.org](https://tomcat.apache.org/download-10.cgi).

2. В меню слева выберите **Tomcat 10**.

3. Найдите раздел **"10.1.xx"** (актуальная версия).

4. В блоке **Core** скачайте архив:

    - **Windows:** `zip` (64-bit Windows zip). _Не скачивайте 32-bit/64-bit Windows Service Installer! Нам нужна именно портативная версия (архив)._

    - **macOS / Linux:** `tar.gz`.


## Шаг 2: Установка (Распаковка)

1. Распакуйте архив в удобное место.

    - **Windows:** Рекомендуется корень диска или папка без пробелов и кириллицы в названии.

        - _Плохо:_ `C:\Users\Вася Пупкин\My Documents\Tomcat`

        - _Хорошо:_ `C:\Tools\apache-tomcat-10.1.x`

    - **macOS:** Обычно распаковывают в папку `Home` пользователя или `/usr/local` (но проще в Home).

2. **Запомните путь к папке!** Это ваш `CATALINA_HOME`.


### Кратко о структуре папок (что нужно знать):

- `/bin` — скрипты запуска и остановки (`startup.bat` / `shutdown.sh`).

- `/conf` — настройки сервера (порт 8080 меняется в `server.xml`).

- `/webapps` — сюда складываются скомпилированные `.war` файлы.

- `/logs` — сюда нужно смотреть, если сервер не запускается (файл `catalina.out`).


---

## Шаг 3: Настройка в IntelliJ IDEA

Посмотрите, какая у вас версия IDEA (в верхнем меню `Help` -> `About`).

### Вариант А: IntelliJ IDEA Ultimate (Рекомендуемый)

В этой версии поддержка серверов приложений встроена нативно.

1. Откройте ваш проект.

2. Справа сверху (возле зеленой кнопки Play) нажмите на выпадающий список -> **Edit Configurations...**

3. Нажмите **"+"** (слева сверху) -> выберите **Tomcat Server** -> **Local**.

    - _Если не находите Tomcat в списке, прокрутите вниз и нажмите "X items more..."_.

4. **Настройка сервера:**

    - В поле **Application server** нажмите **Configure...** -> укажите путь к папке, куда вы распаковали Tomcat (Шаг 2).

    - После выбора IDEA должна определить версию (например, 10.1.25).

5. **Настройка деплоя (вкладка Deployment):**

    - Перейдите на вкладку **Deployment**.

    - Нажмите **"+"** -> **Artifact...**

    - Выберите `название-проекта:war exploded`.

        - _Почему exploded? Это распакованная версия, она позволяет обновлять html/css файлы "на лету" без перезагрузки сервера._

    - Внизу проверьте поле **Application context**. По умолчанию там может быть длинный путь `/feedback_app_war_exploded`. Измените его на `/` (корневой путь) или `/app`, чтобы URL был короче (`localhost:8080/app`).

6. Нажмите **OK**.


### Вариант Б: IntelliJ IDEA Community (Бесплатная)

В "Community" версии нет вкладки "Tomcat Server". Нам понадобится плагин.

1. **Установка плагина:**

    - `File` -> `Settings` (Windows) или `IntelliJ IDEA` -> `Settings` (macOS).

    - В меню слева выберите **Plugins**.

    - В поиске наберите **"Smart Tomcat"**.

    - Нажмите **Install** и перезагрузите IDEA.

2. **Настройка конфигурации:**

    - Справа сверху нажмите **Edit Configurations...**

    - Нажмите **"+"** -> выберите **Smart Tomcat**.

    - **Name:** `Tomcat 10`.

    - **Tomcat Server:** Нажмите кнопку настроек и укажите путь к распакованной папке Tomcat.

    - **Deployment Directory:** Укажите путь к папке `src/main/webapp` вашего проекта.

    - **Context Path:** `/feedback` (или как хотите называть приложение в URL).

    - **Server Port:** `8080`.

3. Нажмите **OK**.


---

## Шаг 4: Первый запуск

1. Нажмите зеленую кнопку **Run** (треугольник) или `Shift+F10`.

2. Внизу откроется панель **Services** (или Run), где побегут логи сервера.

3. **Успешный старт:** Вы должны увидеть строчку похожую на:

   `org.apache.catalina.startup.Catalina.start Server startup in [1234] ms`

4. Если IDEA сама не открыла браузер, откройте его вручную и перейдите по адресу:

   `http://localhost:8080/ваш-context-path` (или просто `http://localhost:8080`, если context path `/`).


---

## Частые ошибки (Troubleshooting)

**1. Ошибка "Port 8080 is already in use"**

- **Причина:** Порт занят другим процессом (часто это другой запущенный экземпляр Tomcat или Oracle XE).

- **Решение:**

    - Остановите предыдущий запуск (красный квадрат в IDEA).

    - Или смените порт в настройках Run Configuration на `8081`.


**2. Для пользователей macOS/Linux: "Permission denied"**

- **Причина:** У скриптов запуска нет прав на исполнение.

- **Решение:** Откройте терминал, перейдите в папку `apache-tomcat/bin` и выполните команду:

  `chmod +x *.sh`


**3. Ошибка "java.lang.ClassNotFoundException: jakarta.servlet.http.HttpServlet"**

- **Причина:** Вы скачали Tomcat 9 (или ниже), а в коде используете `jakarta.*`. Или наоборот.

- **Решение:** Убедитесь, что версия Tomcat **10.1.x** и в `pom.xml` зависимость `jakarta.servlet-api` версии `6.0.0` (или 5.0.0).


**4. В браузере ошибка 404**

- **Причина:** Неверный URL.

- **Решение:** Проверьте **Deployment Context Path** в настройках запуска. Если там написано `/myapp`, то адрес должен быть `localhost:8080/myapp`. Если вы пытаетесь открыть сервлет, убедитесь, что в URL есть его маппинг (например, `localhost:8080/myapp/feedback`).